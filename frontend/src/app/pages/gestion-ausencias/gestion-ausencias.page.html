<!-- frontend/src/app/pages/gestion-ausencias/gestion-ausencias.page.html -->
<div class="container-fluid mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>GestiÃ³n de Ausencias</h2>
    <button class="btn btn-outline-secondary" (click)="cargarAusencias()" [disabled]="loading">
      ğŸ”„ Actualizar
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando ausencias...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="alert alert-danger" role="alert">
    {{ error }}
  </div>

  <!-- Tabla de ausencias -->
  <div *ngIf="!loading && !error" class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>Trabajador</th>
              <th>Tipo</th>
              <th>Fecha Inicio</th>
              <th>Fecha Fin</th>
              <th>Motivo</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let ausencia of ausencias">
              <td>
                <strong>{{
                  ausencia.trabajador_nombre || 'Trabajador ' + ausencia.trabajador_id
                }}</strong>
              </td>
              <td>
                <span [class]="getTipoClass(ausencia.tipo)">
                  {{ ausencia.tipo }}
                </span>
              </td>
              <td>{{ ausencia.fecha_inicio | date : 'dd/MM/yyyy' }}</td>
              <td>{{ ausencia.fecha_fin | date : 'dd/MM/yyyy' }}</td>
              <td>{{ ausencia.motivo }}</td>
              <td>
                <span [class]="getBadgeClass(ausencia.estado)">
                  {{ ausencia.estado }}
                </span>
              </td>
              <td>
                <div *ngIf="ausencia.estado === 'pendiente'" class="btn-group btn-group-sm">
                  <button
                    class="btn btn-success"
                    (click)="aprobarAusencia(ausencia)"
                    title="Aprobar ausencia"
                  >
                    âœ… Aprobar
                  </button>
                  <button
                    class="btn btn-danger"
                    (click)="rechazarAusencia(ausencia)"
                    title="Rechazar ausencia"
                  >
                    âŒ Rechazar
                  </button>
                </div>
                <span *ngIf="ausencia.estado !== 'pendiente'" class="text-muted small">
                  Gestionada
                </span>
              </td>
            </tr>
          </tbody>
        </table>

        <div *ngIf="ausencias.length === 0" class="text-center text-muted py-5">
          <i class="fas fa-inbox fa-3x mb-3"></i>
          <p>No hay solicitudes de ausencias pendientes.</p>
        </div>
      </div>
    </div>
  </div>
</div>
