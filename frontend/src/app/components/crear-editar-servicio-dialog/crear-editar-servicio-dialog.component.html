<div class="dialog-container">
  <h2 mat-dialog-title>
    <mat-icon>{{ isEdit ? 'edit' : 'add' }}</mat-icon>
    {{ isEdit ? 'Editar Servicio' : 'Crear Nuevo Servicio' }}
  </h2>

  <mat-dialog-content>
    <form [formGroup]="servicioForm" class="servicio-form">
      <!-- Nombre -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre del Servicio</mat-label>
        <input matInput formControlName="nombre" placeholder="Ej: Corte de pelo" />
        <mat-icon matSuffix>spa</mat-icon>
        <mat-error *ngIf="nombre?.hasError('required')"> El nombre es obligatorio </mat-error>
        <mat-error *ngIf="nombre?.hasError('minlength')">
          El nombre debe tener al menos 3 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Descripción -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Descripción</mat-label>
        <textarea
          matInput
          formControlName="descripcion"
          placeholder="Describe el servicio..."
          rows="3"
        ></textarea>
        <mat-icon matSuffix>description</mat-icon>
      </mat-form-field>

      <!-- Duración y Precio -->
      <div class="form-row">
        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Duración (minutos)</mat-label>
          <input matInput type="number" formControlName="duracion" min="1" placeholder="30" />
          <mat-icon matSuffix>schedule</mat-icon>
          <mat-error *ngIf="duracion?.hasError('required')"> La duración es obligatoria </mat-error>
          <mat-error *ngIf="duracion?.hasError('min')">
            La duración debe ser al menos 1 minuto
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Precio (€)</mat-label>
          <input
            matInput
            type="number"
            formControlName="precio"
            min="0"
            step="0.01"
            placeholder="0.00"
          />
          <mat-icon matSuffix>euro</mat-icon>
          <mat-error *ngIf="precio?.hasError('required')"> El precio es obligatorio </mat-error>
          <mat-error *ngIf="precio?.hasError('min')">
            El precio debe ser mayor o igual a 0
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Categoría -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Categoría</mat-label>
        <mat-select formControlName="categoria">
          <mat-option *ngFor="let cat of categorias" [value]="cat">
            {{ cat }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix>category</mat-icon>
        <mat-error *ngIf="categoria?.hasError('required')"> La categoría es obligatoria </mat-error>
      </mat-form-field>

      <!-- Activo -->
      <mat-checkbox formControlName="activo" color="primary">
        Servicio activo (disponible para reservas)
      </mat-checkbox>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" [disabled]="loading">
      <mat-icon>cancel</mat-icon>
      Cancelar
    </button>
    <button
      mat-raised-button
      color="primary"
      (click)="onSubmit()"
      [disabled]="servicioForm.invalid || loading"
    >
      <mat-icon>{{ isEdit ? 'save' : 'add' }}</mat-icon>
      {{ isEdit ? 'Actualizar' : 'Crear' }} Servicio
      <mat-spinner diameter="20" *ngIf="loading" class="button-spinner"></mat-spinner>
    </button>
  </mat-dialog-actions>
</div>
